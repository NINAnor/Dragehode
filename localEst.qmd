---
editor: visual
lang: no
fontenc: iso-8859-1
---

# Lokale estimater av populasjonsstÃ¸rrelse {#sec-local}

Disse figurene viser estimert populasjonsstÃ¸rrelse, totalt og fordelt på de tre størrelsesklassene fertile, vegetative og smÂ¥planter, for hvert Â¥r i lokalitetene som inngÂ¥r i overvÃ¥kingen.

PopulasjonsstÂ¸rrelse er estimert ved Â¥ bruke tettheten av individer i overvÂ¥kingsrutene, samt arealet dragehode forekommer pÃ¥ (registrert i forekomstruter langs transekter) innenfor lokaliteten. Usikkerheten i populasjonsestimatene ble beregnet ved tilfeldige trekninger av forekomstruter og overvÃ¥kingsruter (Ã¢â¬ËbootstrappingÃ¢â¬â¢) med 2000 gjentak. Bootstrapping er en re-samplingsmetode som gjÂ¸r det mulig Â¥ beregne usikkerhet rundt en gjennomsnittsverdi. Strekene viser gjennomsnittsverdi, mens de skraverte feltene viser 95 % konfidensintervaller.

Fordi vi bruker tettheten av individer i overvÃ¥kingsrutene, er populasjonsstÃ¸rrelse bare beregnet i 2023 for de lokalitetene der detaljert overvÃ¥king, med bÃ¥de overvÃ¥kingsruter og transekter, ble gjennomfÃ¸rt. Se rapporten for detaljer.

```{r}
#| echo: false
#| message: false
#| warning: false

library(tidyverse)

lokalitetsestimater <- readRDS(paste0(here::here(), "/data/derived_data/lokalitetsestimater.RDS"))

# A quick fix but needs to be addressed back in the function to create estimates 

lokalitetsestimater$`Nordre Ultvet`$year<-c(2019, 2020, 2021, 2022, 2023)

lokalitetsdata <- readRDS("C:/Users/matthew.grainger/Documents/Projects_in_development/Dragehode2023/data/lokalitetsdata.RDS")

plotLocEst<-function(i){
  


title=lokalitetsestimater[[i]]$lokalitet
popstr=as_tibble(lokalitetsestimater[[i]])
names(popstr)<-c( "lokalitet" ,"year",      "Fertile",     "Vegetative",      "SmÃƒÂ¥planter",      "Totalt",     
                    "Fert.CI",   "Veg.CI",    "Sma.CI",    "Tot.CI" )
  
  
popstrCI=popstr %>% 
    mutate("Fert.CI_upper"= Fert.CI[,2]) %>% 
    mutate("Fert.CI_lower"= Fert.CI[,1]) %>% 
    mutate("Tot.CI_upper"= Tot.CI[,2]) %>% 
    mutate("Tot.CI_lower"= Tot.CI[,1]) %>%
    mutate("Veg.CI_upper"= Veg.CI[,2]) %>% 
    mutate("Veg.CI_lower"= Veg.CI[,1]) %>%
    mutate("Sma.CI_upper"= Sma.CI[,2]) %>% 
    mutate("Sma.CI_lower"= Sma.CI[,1]) %>%
    select(!lokalitet) %>% 
    pivot_longer(!year, names_to = "key", values_to = "value") %>% 
    filter(key%in% c("Fert.CI", "Veg.CI","Sma.CI", "Tot.CI")) %>% 
    mutate(var=gsub(".CI","", key))
  
  popstrCI=popstrCI%>% 
    mutate(var=rep(c("Fertile", "Vegetative", "SmÃƒÂ¥planter", "Totalt"),(dim(popstrCI)[1]/4))) %>% 
    mutate(upper=value[,2]) %>% 
    mutate(lower=value[,1]) %>% 
    select(!value)
    
  
  
popstr_plot=popstr %>% 
    mutate("Fert.CI_upper"= Fert.CI[,2]) %>% 
    mutate("Fert.CI_lower"= Fert.CI[,1]) %>% 
    mutate("Tot.CI_upper"= Tot.CI[,2]) %>% 
    mutate("Tot.CI_lower"= Tot.CI[,1]) %>%
    mutate("Veg.CI_upper"= Veg.CI[,2]) %>% 
    mutate("Veg.CI_lower"= Veg.CI[,1]) %>%
    mutate("Sma.CI_upper"= Sma.CI[,2]) %>% 
    mutate("Sma.CI_lower"= Sma.CI[,1]) %>%
    select(!lokalitet) %>% 
    pivot_longer(!year, names_to = "key", values_to = "value") %>%
    #filter(!key%in% c("Fert.CI", "Veg.CI","Sma.CI", "Tot.CI")) %>% 
    filter(key%in% c("Fertile", "SmÃƒÂ¥planter", "Totalt", "Vegetative")) %>% 
    mutate(upper=popstrCI$upper) %>% 
    mutate(lower=popstrCI$lower)
  
p=popstr_plot%>% 
    ggplot(aes(year,value[,1], colour=key))+
    geom_point(size=2)+
    geom_ribbon(aes(ymin=lower, ymax=upper, fill=key), alpha=0.2)+
    scale_fill_manual(values = c("darkred", "darkblue", "darkgrey", "darkgreen"), guide="none")+
    geom_line( size=1.2)+
   scale_colour_manual(values = c("darkred", "darkblue", "darkgrey", "darkgreen"))+
    labs(x="Ãƒâ€¦r", y= "Antall individer")+
    ggtitle(title)+
    theme_classic()+
  xlim(2017,year(Sys.Date()))

p}
```

## Hadeland

```{r}
#| echo: false
#| message: false
#| warning: false

Hadeland_list<-lokalitetsdata |> 
  filter(Region=="Hadeland") |> 
  distinct(Lokalitet)
#Aslaksrud
#Falang
#Gjefsen
#Gran sykehjem
#Grindaker
#Lyngstad Vestre
#Nedre RÃ¸ykenvik
#Ãvre RÃ¸ykenvik
plotLocEst(i=1)
plotLocEst(i=9)
plotLocEst(i=10)
plotLocEst(i=11)
plotLocEst(i=12)
plotLocEst(i=23)




```

## Oslo

```{r}
#| echo: false
#| message: false 
#| warning: false

Oslo_list<-lokalitetsdata |> 
  filter(Region=="Oslo") |> 
  distinct(Lokalitet)

#EkebergskrÃ¥ningen
#         Heggholmen
#             Horgen
#           HovedÃ¸ya
#         HovedÃ¸ya V
#            KalvÃ¸ya
#         MÃ¸llerenga
#         Spireodden
#        StorÃ¸ykilen
#      Svartorseter
#           Telenor
#        Vendelenga
#        Viernbukta

plotLocEst(i=7) 
plotLocEst(i=14) 
plotLocEst(i=15) 
plotLocEst(i=16) 
plotLocEst(i=17) 
plotLocEst(i=20)
plotLocEst(i=24) 
plotLocEst(i=29) 
plotLocEst(i=33) 
plotLocEst(i=34) 
plotLocEst(i=37) 
plotLocEst(i=39) 

```

## Ringerike

```{r}
#| echo: false 
#| message: false 
#| warning: false

Ringerike_list<-lokalitetsdata |> 
  filter(Region=="Ringerike") |> 
  distinct(Lokalitet)

#                            Auren
#                       Buss-stopp
# Haugsbygd, vestvendt vegskrÃ¥ning
#                        HurumÃ¥sen
#                    Nordre Ultvet
#                        Ultvet SÃ
#                     Ãsaporten NÃ

plotLocEst(i=2) 
plotLocEst(i=4) 
plotLocEst(i=13) 
plotLocEst(i=18) 
plotLocEst(i=25) 
plotLocEst(i=38)
plotLocEst(i=41) 


```

## Gudbrandsdalen

```{r}
#| echo: false
#| message: false
#| warning: false
#Dampsaga 6
#Storberget 32
#Solbakken 28
#Syltbakkin 35
#Steberg 30
plotLocEst(i=6) 
#plotLocEst(i=32) 
#plotLocEst(i=28) 
#plotLocEst(i=35) 
#plotLocEst(i=30) 


```

## MjÃ¸sa

```{r}
#| echo: false
#| message: false
#| warning: false
#Kvennom 22
#Røyse 27
#Jøråsen 19
#Kvamsberget sør 21
#Sterud, Østre III 31

#plotLocEst(i=22) 
plotLocEst(i=27) 
plotLocEst(i=19) 
#plotLocEst(i=21) 
#plotLocEst(i=31) 


```

## Valdres

```{r}
#| echo: false
#| message: false
#| warning: false
#Brone 3
#Enger 8
#Sørre Skrindsrud 36
#Ryparten, vegkant 26
#Bøseimarke 5
plotLocEst(i=3) 
#plotLocEst(i=8) 
#plotLocEst(i=36) 
#plotLocEst(i=26) 
#plotLocEst(i=5) 

```
